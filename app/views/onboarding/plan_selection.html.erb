<!-- Plan Selection View -->

<div class="container mx-auto px-4 py-8 max-w-5xl">
  <div class="text-center mb-10">
    <h1 class="text-3xl font-bold text-gray-800 mb-2">Seleccione su Plan</h1>
    <p class="text-lg text-gray-600">Elija el plan que mejor se adapte a sus necesidades</p>
  </div>

  <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-12">
    <% @subscription_plans.each do |plan| %>
      <div class="bg-white rounded-lg shadow-lg overflow-hidden border border-gray-200 hover:border-sky-500 transition-all">
        <div class="p-6 bg-gradient-to-r from-sky-500 to-sky-700 text-white">
          <h3 class="text-xl font-bold mb-2"><%= plan.name %></h3>
          <p class="text-2xl font-bold"><%= plan.price_in_dollars %> <span class="text-sm font-normal">/ <%= plan.interval_display %></span></p>
        </div>
        <div class="p-6">
          <ul class="space-y-3 mb-6">
            <% plan.features.to_s.split(',').each do |feature| %>
              <li class="flex items-center">
                <svg class="h-5 w-5 text-green-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
                <%= feature.strip %>
              </li>
            <% end %>
          </ul>
          
          <div class="mt-6 space-y-4">
            <% if plan.name.downcase.include?('gratuito') || plan.price == 0 %>
              <div class="bg-gray-50 p-4 rounded-lg">
                <h4 class="font-medium text-gray-700 mb-2">Plan Gratuito - Solo Visualización</h4>
                <p class="text-sm text-gray-600 mb-4">Este plan permite únicamente visualizar perfiles, sin posibilidad de edición.</p>
                
                <%= form_with url: onboarding_plan_confirmation_path, method: :post do |f| %>
                  <%= f.hidden_field :plan_id, value: plan.id %>
                  <%= f.hidden_field :profile_type, value: 'viewer' %>
                  <div class="mt-4">
                    <%= f.submit "Seleccionar Plan Gratuito", class: "w-full py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-sky-500 hover:bg-sky-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-sky-500" %>
                  </div>
                <% end %>
              </div>
            <% else %>
              <h4 class="font-medium text-gray-700 mb-2">¿Qué tipo de perfil desea crear?</h4>
              
              <%= form_with url: onboarding_plan_confirmation_path, method: :post, class: "space-y-4" do |f| %>
                <%= f.hidden_field :plan_id, value: plan.id %>
                
                <div class="flex items-center p-3 border rounded-lg hover:bg-gray-50 cursor-pointer">
                  <%= f.radio_button :profile_type, 'doctor', class: "h-4 w-4 text-sky-600 focus:ring-sky-500", required: true %>
                  <%= f.label :profile_type, value: 'doctor', class: "ml-3 block text-sm font-medium text-gray-700" do %>
                    <div class="font-medium">Doctor</div>
                    <div class="text-xs text-gray-500">Para médicos individuales</div>
                  <% end %>
                </div>
                
                <div class="flex items-center p-3 border rounded-lg hover:bg-gray-50 cursor-pointer">
                  <%= f.radio_button :profile_type, 'hospital', class: "h-4 w-4 text-sky-600 focus:ring-sky-500" %>
                  <%= f.label :profile_type, value: 'hospital', class: "ml-3 block text-sm font-medium text-gray-700" do %>
                    <div class="font-medium">Hospital</div>
                    <div class="text-xs text-gray-500">Para hospitales con múltiples especialidades</div>
                  <% end %>
                </div>
                
                <div class="flex items-center p-3 border rounded-lg hover:bg-gray-50 cursor-pointer">
                  <%= f.radio_button :profile_type, 'clinic', class: "h-4 w-4 text-sky-600 focus:ring-sky-500" %>
                  <%= f.label :profile_type, value: 'clinic', class: "ml-3 block text-sm font-medium text-gray-700" do %>
                    <div class="font-medium">Clínica</div>
                    <div class="text-xs text-gray-500">Para clínicas especializadas</div>
                  <% end %>
                </div>
                
                <div class="mt-6">
                  <%= f.submit "Seleccionar Plan", class: "w-full py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-sky-500 hover:bg-sky-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-sky-500" %>
                </div>
              <% end %>
            <% end %>
          </div>
        </div>
      </div>
    <% end %>
  </div>
</div>
