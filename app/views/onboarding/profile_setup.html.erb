<div class="container mx-auto px-4 py-8 max-w-3xl">
  <div class="text-center mb-10">
    <h1 class="text-3xl font-bold text-gray-800 mb-2">Configure su Perfil</h1>
    <p class="text-lg text-gray-600">
      <% case @profile_type %>
      <% when 'doctor' %>Complete la información de su perfil médico
      <% when 'hospital' %>Complete la información de su hospital
      <% when 'clinic' %>Complete la información de su clínica
      <% end %>
    </p>
  </div>

  <div class="bg-white rounded-lg shadow-lg overflow-hidden border border-gray-200 mb-8">
    <div class="p-6">
      <% if @profile_type == 'doctor' %>
        <%= form_with model: @doctor_profile, url: onboarding_profile_confirmation_path, method: :post, class: "space-y-6" do |f| %>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <%= f.label :name, "Nombre completo", class: "block text-sm font-medium text-gray-700" %>
              <%= f.text_field :name, class: "mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm", required: true %>
            </div>
            
            <div data-controller="subspecialty">
              <div>
                <%= f.label :specialty_id, "Especialidad", class: "block text-sm font-medium text-gray-700" %>
                <%= f.select :specialty_id,
                            options_for_select(@specialties.map { |s| [s.name, s.id] }, @doctor_profile.specialty_id),
                            { include_blank: "Selecciona una especialidad" },
                            { class: "mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",
                              data: { action: "change->subspecialty#updateSubspecialties", subspecialty_target: "specialty" }, required: true } %>
              </div>

              <div>
                <%= f.label :subspecialty_id, "Subespecialidad", class: "block text-sm font-medium text-gray-700" %>
                <%= f.select :subspecialty_id,
                            options_for_select(@subspecialties.map { |s| [s.name, s.id] }, @doctor_profile.subspecialty_id),
                            { include_blank: "Selecciona una subespecialidad (opcional)" },
                            { class: "mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",
                              data: { subspecialty_target: "subspecialty" } } %>
              </div>
            </div>

            <div>
              <%= f.label :phone, "Teléfono", class: "block text-sm font-medium text-gray-700" %>
              <%= f.telephone_field :phone, class: "mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm" %>
            </div>
            
            <div>
              <%= f.label :department_id, "Departamento", class: "block text-sm font-medium text-gray-700" %>
              <%= f.select :department_id,
                          options_for_select(@departments.map { |d| [d.name, d.id] }, @doctor_profile.department_id),
                          { include_blank: "Selecciona un departamento" },
                          { class: "mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm", required: true } %>
            </div>

            <div>
              <%= f.label :city_id, "Ciudad", class: "block text-sm font-medium text-gray-700" %>
              <%= f.select :city_id,
                          options_for_select(@cities.map { |c| [c.name, c.id] }, @doctor_profile.city_id),
                          { include_blank: "Selecciona una ciudad" },
                          { class: "mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm", required: true } %>
            </div>
          </div>

          <div>
            <%= f.label :education, "Educación y certificaciones", class: "block text-sm font-medium text-gray-700" %>
            <%= f.text_area :education, rows: 3, class: "mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm" %>
          </div>
          
          <div>
            <%= f.label :experience, "Experiencia profesional", class: "block text-sm font-medium text-gray-700" %>
            <%= f.text_area :experience, rows: 3, class: "mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm" %>
          </div>
          
          <div>
            <%= f.label :bio, "Biografía", class: "block text-sm font-medium text-gray-700" %>
            <%= f.text_area :bio, rows: 4, class: "mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm" %>
          </div>
          
          <div class="flex justify-between">
            <%= link_to "Volver", onboarding_plan_confirmation_path(plan_id: @plan.id, profile_type: @profile_type), class: "py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500" %>
            
            <%= f.submit "Guardar y Continuar", class: "py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500" %>
          </div>
        <% end %>
        
      <% elsif @profile_type == 'hospital' || @profile_type == 'clinic' %>
        <%= form_with model: @establishment, url: onboarding_profile_confirmation_path, method: :post, class: "space-y-6" do |f| %>
          <%= f.hidden_field :est_type, value: @profile_type %>
          
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <%= f.label :name, "Nombre del #{@profile_type == 'hospital' ? 'hospital' : 'clínica'}", class: "block text-sm font-medium text-gray-700" %>
              <%= f.text_field :name, class: "mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm", required: true %>
            </div>
            
            <div>
              <%= f.label :phone, "Teléfono", class: "block text-sm font-medium text-gray-700" %>
              <%= f.telephone_field :phone, class: "mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm" %>
            </div>
            
            <div>
              <%= f.label :address, "Dirección", class: "block text-sm font-medium text-gray-700" %>
              <%= f.text_field :address, class: "mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm", required: true %>
            </div>
            
            <div>
              <%= f.label :city, "Ciudad", class: "block text-sm font-medium text-gray-700" %>
              <%= f.text_field :city, class: "mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm", required: true %>
            </div>
            
            <div>
              <%= f.label :state, "Departamento", class: "block text-sm font-medium text-gray-700" %>
              <%= f.text_field :state, class: "mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm", required: true %>
            </div>
            
            <div>
              <%= f.label :website, "Sitio web", class: "block text-sm font-medium text-gray-700" %>
              <%= f.url_field :website, class: "mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm" %>
            </div>
          </div>
          
          <div>
            <%= f.label :description, "Descripción", class: "block text-sm font-medium text-gray-700" %>
            <%= f.text_area :description, rows: 4, class: "mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm" %>
          </div>
          
          <div class="flex justify-between">
            <%= link_to "Volver", onboarding_plan_confirmation_path(plan_id: @plan.id, profile_type: @profile_type), class: "py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500" %>
            
            <%= f.submit "Guardar y Continuar", class: "py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500" %>
          </div>
        <% end %>
      <% end %>
    </div>
  </div>
</div>
